<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mixtures of multivariate Gaussian distributions • vimix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mixtures of multivariate Gaussian distributions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-128138627-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-128138627-5');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vimix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play-circle"></span>
     
    Vignettes
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-pencil"></span>
     
    Documentation
  </a>
</li>
<li>
  <a href="https://github.com/acabassi/vimix">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Mixtures of multivariate Gaussian distributions</h1>
                        <h4 class="author">Alessandra Cabassi</h4>
            
            <h4 class="date">2019-04-01</h4>
      
      
      <div class="hidden name"><code>vimix.Rmd</code></div>

    </div>

    
    
<div id="mixtures-of-multivariate-gaussians" class="section level2">
<h2 class="hasAnchor">
<a href="#mixtures-of-multivariate-gaussians" class="anchor"></a>Mixtures of multivariate Gaussians</h2>
<p>Suppose we have a small dataset containing two clusters.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(mvtnorm)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(vimix)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">## Load a dataset containing 200 2-dimensional data points</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/mvtnorm/topics/Mvnorm">rmvnorm</a></span>(<span class="dv">100</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">0</span>)), <span class="kw"><a href="https://www.rdocumentation.org/packages/mvtnorm/topics/Mvnorm">rmvnorm</a></span>(<span class="dv">100</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">0</span>)))</a></code></pre></div>
<p>Then we can use the function <em>vimix</em> to fit a mixture of multivariate Gaussian distributions:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">## Use variational inference for mixture of Gaussians to find clusters</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/vimix.html">vimix</a></span>(data, <span class="dt">K =</span> <span class="dv">7</span>, <span class="dt">verbose =</span> T)</a></code></pre></div>
<p>Let’s see what our clusters look like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">## Plot cluster labels</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(broom)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gridExtra)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">## Convert data matrix and cluster labels to data.frame</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/broom/topics/reexports">tidy</a></span>(data)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">df<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(output<span class="op">$</span>label)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">## Plot clusters</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(df, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(X1, X2, <span class="dt">col =</span> label)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>()</a></code></pre></div>
<p><img src="vimix_files/figure-html/example1-plot-1.png" width="700"></p>
<p>The lower bound increases at each iteration of the algorithm and can be used to check whether the algorithm has converged. Another interesting value to check at each iteration is the number of non-empty clusters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">## Check that the lower bound is monotonically increasing</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">lb &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/broom/topics/reexports">tidy</a></span>(output<span class="op">$</span>L[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">lb<span class="op">$</span>ELBO &lt;-<span class="st"> </span>lb<span class="op">$</span>x</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">lb<span class="op">$</span>x &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">lb<span class="op">$</span>iter &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(output<span class="op">$</span>L[<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">lb<span class="op">$</span>number_clusters &lt;-<span class="st"> </span>output<span class="op">$</span>Cl[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">## Plot lower bound</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">plot_lb &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(lb, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>iter,<span class="dt">y=</span>ELBO)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>()</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">## Plot number of non-empty clusters</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">plot_nc &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(lb, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>iter,<span class="dt">y=</span>number_clusters)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>()</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(plot_lb, plot_nc, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="vimix_files/figure-html/example1-lb-1.png" width="700"></p>
<p>Finally, it is important to note that the algorithm doesn’t always converge to the same solution. Depending on the initialization, it will converge to different local optima. However, by runnin the algorithm multiple times, we can see that, the optimal solution is almost always reached, in this simple case.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">maxK &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">n_random_starts &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">ELBO &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, maxK<span class="dv">-1</span>, n_random_starts)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>maxK){</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_random_starts){</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">        output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/vimix.html">vimix</a></span>(data, <span class="dt">K =</span> k)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">        ELBO[k<span class="dv">-1</span>,j] &lt;-<span class="st"> </span>output<span class="op">$</span>L[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(output<span class="op">$</span>L)]</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">    }</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(reshape)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">ELBO &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reshape/topics/melt-24">melt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(ELBO))</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(ELBO) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'start_n'</span>, <span class="st">'K'</span>, <span class="st">'ELBO'</span>)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">ELBO<span class="op">$</span>K &lt;-<span class="st"> </span>ELBO<span class="op">$</span>K <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(ELBO, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> K, <span class="dt">y =</span> ELBO)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_jitter">geom_jitter</a></span>()</a></code></pre></div>
<p><img src="vimix_files/figure-html/example1-figure10-7-1.png" width="700"></p>
<p>Now, let’s try to use the same mixture model as above, but with the additional assumption that all the variables are independent.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">## Use variational inference for mixture of Gaussians to find clusters</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/vimix.html">vimix</a></span>(data, <span class="dt">K =</span> <span class="dv">7</span>, <span class="dt">indep =</span> T, <span class="dt">verbose =</span> T)</a></code></pre></div>
<p>We can again check the clustering solution:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">## Convert data matrix and cluster labels to data.frame</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/broom/topics/reexports">tidy</a></span>(data)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">df<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(output<span class="op">$</span>label)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## Plot clusters</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(df, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(X1, X2, <span class="dt">col =</span> label)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>()</a></code></pre></div>
<p><img src="vimix_files/figure-html/example1-ind-plot-1.png" width="700"></p>
<p>and the lower bound and number of non-empty clusters at each iteration:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">## Check that the lower bound is monotonically increasing</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">lb &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/broom/topics/reexports">tidy</a></span>(output<span class="op">$</span>L[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">lb<span class="op">$</span>ELBO &lt;-<span class="st"> </span>lb<span class="op">$</span>x</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">lb<span class="op">$</span>x &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">lb<span class="op">$</span>iter &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(output<span class="op">$</span>L[<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">lb<span class="op">$</span>number_clusters &lt;-<span class="st"> </span>output<span class="op">$</span>Cl[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">## Plot clusters</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">plot_lc &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(lb, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>iter,<span class="dt">y=</span>ELBO)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>()</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">## Plot number of non-empty clusters</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">plot_nc &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(lb, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>iter,<span class="dt">y=</span>number_clusters)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>()</a>
<a class="sourceLine" id="cb8-14" data-line-number="14"></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(plot_lc, plot_nc, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="vimix_files/figure-html/example1-ind-lb-1.png" width="700"></p>
<p>Like before, there is no guarantee that the algorithm will converge to the global optimum. However, we observe in practice that this is usually the case.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">maxK &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">n_random_starts &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">ELBO &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, maxK<span class="dv">-1</span>, n_random_starts)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>maxK){</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_random_starts){</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">        output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/vimix.html">vimix</a></span>(data, <span class="dt">K =</span> k, <span class="dt">indep =</span> T)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">        ELBO[k<span class="dv">-1</span>,j] &lt;-<span class="st"> </span>output<span class="op">$</span>L[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(output<span class="op">$</span>L)]</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    }</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(reshape)</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">ELBO &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reshape/topics/melt-24">melt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(ELBO))</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(ELBO) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'start_n'</span>, <span class="st">'K'</span>, <span class="st">'ELBO'</span>)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">ELBO<span class="op">$</span>K &lt;-<span class="st"> </span>ELBO<span class="op">$</span>K <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(ELBO, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> K, <span class="dt">y =</span> ELBO)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_jitter">geom_jitter</a></span>()</a></code></pre></div>
<p><img src="vimix_files/figure-html/example1-ind-figure10-7-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#mixtures-of-multivariate-gaussians">Mixtures of multivariate Gaussians</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://alessandracabassi.wordpress.com">Alessandra Cabassi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
